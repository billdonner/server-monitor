# Server Monitor â€” Dashboard Configuration

servers:
  # -- Custom servers (HTTP /metrics endpoint) --

  - name: "Alities Engine"
    type: http
    metrics_endpoint: "http://127.0.0.1:9847/metrics"
    poll_every: 15

  - name: "Nagzerver"
    type: http
    metrics_endpoint: "http://127.0.0.1:9800/api/v1/metrics"
    poll_every: 30

  - name: "Server Monitor"
    type: http
    metrics_endpoint: "http://127.0.0.1:9860/metrics"
    poll_every: 10

  # -- Standard services (native protocol) --

  - name: "Redis"
    type: redis
    host: "localhost"
    port: 6379
    poll_every: 10

  - name: "Postgres (Nagz)"
    type: postgres
    dsn: "postgresql://nagz:nagz@localhost:5433/nagz"
    system_stats: true
    poll_every: 15
    queries:
      - label: "Open Nags"
        sql: "SELECT COUNT(*) as value FROM nags WHERE status = 'open'"
        color: yellow
        warn_above: 100
        poll_every: 30

      - label: "Failed Deliveries"
        sql: "SELECT COUNT(*) as value FROM deliveries WHERE status = 'failed'"
        color: red
        warn_above: 10
        poll_every: 60

  - name: "OBO Decks"
    type: postgres
    dsn: "postgresql://nagz:nagz@localhost:5433/obo"
    system_stats: false
    poll_every: 30
    queries:
      - label: "Total Decks"
        sql: "SELECT COUNT(*) as value FROM decks"
        poll_every: 30

      - label: "Total Cards"
        sql: "SELECT COUNT(*) as value FROM cards"
        poll_every: 30

      - label: "Recent (7d)"
        sql: "SELECT COUNT(*) as value FROM decks WHERE created_at > NOW() - INTERVAL '7 days'"
        color: cyan
        poll_every: 60

      - label: "Avg Cards/Deck"
        sql: "SELECT COALESCE(ROUND(AVG(card_count)), 0) as value FROM decks"
        poll_every: 60
